<!DOCTYPE html>
<html>
    <head style="color: darkslategrey;">
        <title style="color: black; text-align: center;">Fate character guessing game</title>
    </head>

    <body style="color: black;">
        <h1 text-align: left;">Guess the fate servant!</h1>
        <p>Guess the characters' name(s) or alias(es) :</p>
    </body>

    <div class="resultParas">
        <p class="guesses"></p>
        <p class="lastResult"></p>
        <p class="lowOrHi"></p>
        <img class="servantImage">
    </div>

    <label for="guessField">Enter a guess: </label>
    <input type="string" id="guessField" class="guessField"/>
    <input type="submit" value="Submit guess" class="guessSubmit"/>

    <script>
        let characters = [
            [
                "Artoria Pendragon",
                ["Artoria Pendragon", "Altria Pendragon", "Artoria", "Altria", "Saber", "King Of Knights"],
                "https://static.wikia.nocookie.net/fategrandorder/images/b/be/S002_Stage4.webp"
            ],
            [
                "EMIYA",
                ["EMIYA", "Emiya Shirou", "Shirou", "Shirou Emiya", "Nameless", "Faker", "Hero Of Justice", "Red Archer"],
                "https://static.wikia.nocookie.net/fategrandorder/images/6/60/S011_Stage4.webp"
            ]
        ];

        const guesses = document.querySelector(".guesses");
        const lastResult = document.querySelector(".lastResult");
        const lowOrHi = document.querySelector(".lowOrHi");
        const servantImage = document.querySelector(".servantImage")

        const guessSubmit = document.querySelector(".guessSubmit");
        const guessField = document.querySelector(".guessField");

        let index;
        let characterInfo;
        let characterName;

        let guessCount;
        let resetButton;

        function validateName(inputName) {
            for (const characterName of characterInfo[1]) {
                if (characterName.toLowerCase() === inputName.toLowerCase()) {
                    return true;
                }
            }
        }

        function newGame() {
            index = Math.floor(Math.random() * characters.length);
            characterInfo = characters[index];
            characterName = characterInfo[0];
            servantImage.src = characterInfo[2];

            guessCount = 1;
        }

        function restart() {
            guessField.disabled = false;
            guessSubmit.disabled = false;
            guessField.value = "";
            guessField.focus();

            resetButton.parentNode.removeChild(resetButton);
            lastResult.style.backgroundColor = "white";
            
            newGame();
        }

        function endGame() { // avengers
            guessSubmit.disabled = true;
            guessField.disabled = true;

            lastResult.disabled = true;
            resetButton = document.createElement("button");
            resetButton.textContent = "Restart, bozo";
            document.body.append(resetButton);
            resetButton.addEventListener("click", restart);
        }

        function checkGuess() {
            const userGuess = guessField.value;

            if (userGuess === "") {
                return;
            }

            if (validateName(userGuess)) {
                lastResult.textContent = `You guessed right, it was ${characterName}!`;
                endGame();

                return;
            }
            else if (guessCount > 2) {
                lastResult.textContent = `You have massive skill issues, the answer was ${characterName}!`;
                endGame();

                return;
            }

            lastResult.textContent = `Guess : ${userGuess} (${3 - guessCount} left)`;

            guessCount++;
            guessField.value = "";
            guessField.focus();
        }

        guessSubmit.addEventListener("click", checkGuess);
        newGame();
    </script>
</html>